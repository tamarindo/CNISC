{% extends "base_admin.html" %}

{% block title %} Editar usuario - CNISC{% endblock %}

{% block style %}

{% endblock %}

{% block body %}

<section>
	<figure class="user-img__options entry-content center-text">
		<div class="user-img-holder">
			<img src="{{ request.user.userext.profile_image_url }}">

			<form class="user-del-form" action="{%url 'eliminar_foto' %}" method="POST" >
				{% csrf_token %}
				<button class="flat remove button" type="submit">
					<i class="icon-remove"> Eliminar</i>
				</button>
			</form>
		</div>

		<form id="update-image" action="{%url 'change_foto'%} " enctype="multipart/form-data" method="POST" >
			{% csrf_token %}
			<button class="flat button blue">Cambiar foto...</button>
			<div class="visuallyhidden">
				{{fromfoto.foto}}
				<input type="submit" class="submit" value="Submit" />
			</div>
		</form>

		<figcaption>
			<p>
				<span class="text-big">{{usuario.get_full_name}}</span>
				<br>
				<span class="gray-text">Cód.: {{usuario.username}}</span>
				<br>
				{% if usuario.userext.student %}
					<span class="gray-text">Semestre:  {{  usuario.userext.student.semestre }} </span>
				{% endif %} 
				<p>
					<a href="" class="button primary ghost">Enviar Mensaje</a>
				</p>
			</p>
		</figcaption>
	</figure>

	<form class="vform" action="{%url 'usereditaradmin' usuario.pk %}" method="POST">
		{% csrf_token %}
		<div class="form-field fluid-grid static">
			<label for="activo">Activo</label>
			<input name="is_active" id="activo" {% if usuario.is_active %} checked {% endif %}  type="checkbox">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Email</label>
			<input name="email" value="{{email_actual}}"  type="text">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Móvil</label>
			<input name="mobile" value="{{usuario.userext.mobile}}"  type="text">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Dirección</label>
			<input name="address" value="{{usuario.userext.address}}"  type="text">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Ciudad</label>
			<input name="city" value="{{usuario.userext.city}}"  type="text">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Estado</label>
			<input name="province" value="{{usuario.userext.province}}"  type="text">
		</div>
		<div class="form-field fluid-grid static">
			<label for="">Pais</label>
			<input name="country" value="{{usuario.userext.country}}"  type="text">
		</div>
		<div class="form-field fluid-grid static password" >
			<label for="">Contraseña</label>
			<input name="pass"  type="password">
		</div>
		<div class="form-field fluid-grid static expand">
			<p><button type="submit" class="flat button blue">Guardar Cambios</button></p>
			<p><button type="button" id="changePassword" class="flat button primay ghost">Cambiar Contraseña</button></p>
		</div>
	</form>

</section>

{% endblock %}


{% block js %}

	<script src="{{STATIC_URL}}/js/multipart-render.js"></script>
	<script>
	(function(){

		// Función para mostrar el input de cambio de contraseña
		'use strict';

		var passButton = document.querySelector('#changePassword'),
			passContent = document.querySelector('.form-field.password');

		passButton.addEventListener('click', function(e){
			e.preventDefault();
			e.stopPropagation();


			passContent.classList.remove('password');
			this.parentNode.remove( this );
		});
	})();
	</script>

{% endblock %}
 